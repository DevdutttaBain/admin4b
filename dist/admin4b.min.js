$(function(){$("input").typing(),$(".as-input").asInput(),$(".input-date").inputDate(),$(".chat").chat(),$('[data-toggle="popover"]').popover(),$('[data-toggle="tooltip"]').tooltip(),$('[data-toggle="suggestion"]').suggestion(),$('[data-toggle="file-manager"]').fileManager()}),function(t){t.fn.camera=function(e){return this.each(function(){switch(e){case"play":t.fn.camera.play.apply(this);break;case"stop":t.fn.camera.stop.apply(this);break;case"snapshot":t.fn.camera.snapshot.apply(this)}})}}(jQuery),function(t){t.fn.chat=function(){return this.each(function(){var e=t(window),n=t(".app-content"),i=t(this),a=i.find(".chat-messages");e.on("resize",function(){var e=0;n.children().each(function(){t(this).is(".chat")||(e+=t(this).outerHeight(!0))}),i.height(n.height()-e),i.addClass("chat-on"),a.scrollToBottom()}),e.trigger("resize")})}}(jQuery),function(t){t.fn.fileManager=function(){return this.each(function(){var e=t(this),n=t("<input/>").attr("type","file");n.on("change",function(){var i=n.get(0).files[0];i&&(t.fn.fileManager.validate(i,e),t.fn.fileManager.read(i,function(){e.trigger("file:change",i)}))}),e.on("click",function(){n.trigger("click")})})}}(jQuery),function(t){t.fn.inputDate=function(){return this.each(function(){var e=t.fn.inputDate.period(2018,3),n=t("#calendar");n.append(t("<tr>").append(t("<th>").text("Su")).append(t("<th>").text("Mo")).append(t("<th>").text("Tu")).append(t("<th>").text("We")).append(t("<th>").text("Th")).append(t("<th>").text("Fr")).append(t("<th>").text("Sa")));for(var i=new Date(2018,3,2),a=e.firstDateInCalendar;a<=e.lastDateInCalendar;){for(var r=t("<tr>"),o=0;o<7;o++){var s=t("<td>");r.append(s),a.getMonth()===e.firstDateInMonth.getMonth()?s.append(t("<a>").attr("href","#").prop("date",a).toggleClass("today",a.getTime()===i.getTime()).text(a.getDate())):s.text(a.getDate()).addClass("disabled"),a=a.addDays(1)}n.append(r)}})}}(jQuery),function(t){t.fn.asInput=function(){return this.each(function(){var e=t(this),n=e.find("input"),i=function(){e.toggleClass("disabled",n.is("[disabled]")),e.toggleClass("readonly",n.is("[readonly]"))};e.on("click",function(){n.focus()}),n.on("focus",function(){e.addClass("focus")}).on("blur",function(){e.removeClass("focus")}).observe(i),i()})}}(jQuery),function(t){t.fn.suggestion=function(e){return this.each(function(){(function(){t(this).data("suggestion:initialized")||(t.fn.suggestion.select.apply(this),t.fn.suggestion.change.apply(this),t(this).is("[data-async]")?t.fn.suggestion.async.apply(this):t.fn.suggestion.static.apply(this),t(this).data("suggestion:initialized",!0))}).apply(this),"refresh"===e&&t(this).trigger("suggestion:refresh")})}}(jQuery),$.fn.onFocusOut=function(t){return this.each(function(){var e=$(document),n=$(this);function i(e){$(e.target).closest(n).length||"function"==typeof t&&t.call(this)}e.on("click",i),e.find("input").on("focus",i),e.find("select").on("focus",i),e.find("textarea").on("focus",i),e.find("button").on("focus",i),e.find("a").on("focus",i)})},function(t){t.fn.observe=function(e){var n=new MutationObserver(function(t){t.forEach(function(t){e.apply(t.target)})});return this.each(function(){var i=t(this);i.on("DOMAttrModified onpropertychange",function(){e.apply(this)}),n.observe(i.get(0),{attributes:!0})})}}(jQuery),function(t){t.fn.scrollToBottom=function(){return this.each(function(){var e=t(this),n=e.prop("scrollHeight");e.scrollTop(n)})}}(jQuery),$.fn.typing=function(){return this.each(function(){var t=$(this),e=null;t.on("input",function(){clearTimeout(e),e=setTimeout(function(){t.trigger("input:delay")},700)})})},$(function(){$('[data-toggle="sidebar"]').on("click",function(){$(".app-sidebar").addClass("sidebar-open")}),$('[data-dismiss="sidebar"]').on("click",function(){$(".app-sidebar").removeClass("sidebar-open")})}),Date.prototype.addDays=function(t){var e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e},window.keyboard=function(t){return this.isArrowDown=function(){return 40===t},this.isArrowUp=function(){return 38===t},this.isEnter=function(){return 13===t},this.isEscape=function(){return 27===t},this},String.prototype.contains=function(t){return new RegExp(t,"i").test(this)},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t,"g"),e)},jQuery.fn.camera.toBlob=function(t){var e;e=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);for(var n=t.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(e.length),a=0;a<e.length;a++)i[a]=e.charCodeAt(a);return new Blob([i],{type:n})},jQuery.fn.camera.link=function(t,e){if("srcObject"in t)t.srcObject=e;else if(navigator.mozGetUserMedia)t.mozSrcObject=e;else{var n=window.URL||window.webkitURL||window.mozURL||window.msURL;t.src=n.createObjectURL(e)}},jQuery.fn.camera.getUserMedia=function(t,e,n){navigator.getUserMedia?navigator.getUserMedia(t,e,n):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(t,e,n):navigator.mozGetUserMedia?navigator.mozGetUserMedia(t,e,n):navigator.msGetUserMedia&&navigator.msGetUserMedia(t,e,n)},function(t){t.fn.camera.play=function(){var e=t(this);if(!e.prop("playing")){var n=e.get(0);t.fn.camera.getUserMedia({video:!0,audio:!1},function(i){t.fn.camera.link(n,i),n.play(),e.prop("stream",i),e.prop("playing",!0),e.trigger("camera:play")},function(t){e.trigger("camera:error",t)})}}}(jQuery),function(t){var e=/^(\d+)x(\d+)$/gi;t.fn.camera.snapshot=function(){var n=t(this);if(n.prop("playing")){var i=n.get(0),a=function(t){if(!t||!t.match(e))return{width:320,height:240};var n=e.exec(t);return{width:n[1],height:n[2]}}(n.attr("data-size")),r=document.createElement("canvas");r.width=a.width,r.height=a.height;var o=r.getContext("2d");o.translate(a.width,0),o.scale(-1,1),o.drawImage(i,0,0,a.width,a.height);var s=r.toDataURL(),u=t.fn.camera.toBlob(s);u.dataURL=s,n.trigger("camera:snapshot",u)}}}(jQuery),function(t){t.fn.camera.stop=function(){var e=t(this);if(e.prop("playing")){var n=e.prop("stream");if(n.getVideoTracks&&"function"==typeof n.getVideoTracks){var i=n.getVideoTracks();i&&i[0]&&i[0].stop&&i[0].stop()}else n.stop&&n.stop();e.prop("playing",!1),e.prop("stream",null),e.trigger("camera:stop")}}}(jQuery),jQuery.fn.fileManager.read=function(t,e){var n=new FileReader;n.readAsDataURL(t),n.onload=function(n){t.dataURL=n.target.result,e()}},function(t){t.fn.fileManager.validate=function(e,n){var i=n.attr("data-maxsize"),a=n.attr("data-type");e.errors=[],t.fn.fileManager.validate.maxsize(e,i)||e.errors.push("maxsize"),t.fn.fileManager.validate.type(e,a)||e.errors.push("type")}}(jQuery),jQuery.fn.inputDate.period=function(t,e){var n=new Date(t,e,1),i=new Date(t,e,new Date(t,e+1,0).getDate()),a=new Date(n);a.setDate(n.getDate()-n.getDay());var r=new Date(i);return r.setDate(i.getDate()+(6-i.getDay())),{firstDateInMonth:n,lastDateInMonth:i,firstDateInCalendar:a,lastDateInCalendar:r}},function(t){t.fn.suggestion.async=function(){var e=t(this),n=e.closest(".input-suggestion").find(".input-suggestion-list"),i=n.find(".list-group.items").hide(),a=n.find(".list-group.empty").hide(),r=n.find(".list-group.loading").hide();e.on("input",function(){r.show(),a.hide(),i.hide()}).on("input:delay suggestion:show",function(){e.trigger("suggestion:search")}).on("suggestion:refresh",function(){t.fn.suggestion.change.apply(this),i.children().length?i.show():a.show(),r.hide()})}}(jQuery),function(t){t.fn.suggestion.change=function(){var e=t(this),n=e.closest(".input-suggestion"),i=n.find(".input-suggestion-list").find(".list-group.items").children(),a=function(n){e.val(t.fn.suggestion.textOf(n)),e.trigger("suggestion:change",n)};i.on("click",function(){n.removeClass("open"),a(this)}),e.on("keypress",function(t){var e=t.keyCode||t.which;if(keyboard(e).isEnter()){var n=i.filter(".active");n.length&&a(n.filter(".active"))}})}}(jQuery),function(t){t.fn.suggestion.select=function(){var e=t(this),n=e.closest(".input-suggestion"),i=n.find(".input-suggestion-list").find(".list-group.items"),a=function(){n.is(".open")||(i.children().removeClass("active"),n.addClass("open"),e.trigger("suggestion:show"))},r=function(){n.is(".open")&&(n.removeClass("open"),e.trigger("suggestion:hide"))};n.onFocusOut(r),e.on("input",a).on("keyup",function(t){var e=t.keyCode||t.which;keyboard(e).isEscape()&&r()}).on("keydown",function(t){var e=t.keyCode||t.which,r=keyboard(e);if(r.isArrowUp()||r.isArrowDown()){if(t.preventDefault(),!n.is(".open"))return void a();var o=i.children(".active");if(r.isArrowDown()){if(o.is(":last-child"))return;o.length?(o.removeClass("active"),o.next().addClass("active")):i.children().eq(0).addClass("active")}if(r.isArrowUp()){if(o.is(":first-child"))return;o.removeClass("active"),o.prev().addClass("active")}}}).on("suggestion:change",r)}}(jQuery),function(t){t.fn.suggestion.static=function(){var e=t(this),n=e.closest(".input-suggestion").find(".input-suggestion-list"),i=n.find(".list-group.empty").hide(),a=n.find(".list-group.items"),r=a.children(),o=[],s=function(){r.removeClass("active"),o.forEach(function(t){var e=t.data("prev");e.length?t.insertAfter(e):a.prepend(t)}),o=[],r.each(function(){var n=t(this);t.fn.suggestion.textOf(n).contains(e.val())||(o.push(n),n.data("prev",n.prev()))}),o.forEach(function(t){t.detach()}),a.children().length?(i.hide(),a.show()):(a.hide(),i.show())};e.on("input",s).on("suggestion:show",s)}}(jQuery),function(t){t.fn.suggestion.textOf=function(e){var n=t(e),i=n.closest(".input-suggestion").find("input");return i.is("[data-text]")&&(n=n.find(i.attr("data-text"))),n.text().trim()}}(jQuery),function(t){var e=/^(\d*\.?\d+)(B|KB|MB|GB)?$/gi,n={B:0,KB:1,MB:2,GB:3};jQuery.fn.fileManager.validate.maxsize=function(t,i){if(!i)return!0;if(!i.match(e))return!1;var a=e.exec(i),r=a[1],o=a[2];return t.size<=(s=r,u=o,Number(s)*Math.pow(1024,n[u]));var s,u}}(),jQuery.fn.fileManager.validate.type=function(t,e){if(!e)return!0;var n="^"+e.replaceAll(",","|")+"$";return new RegExp(n).test(t.type)};