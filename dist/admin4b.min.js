$(function(){$("input").typing(),$(".as-input").asInput(),$(".chat").chat(),$('[data-toggle="popover"]').popover(),$('[data-toggle="tooltip"]').tooltip(),$('[data-toggle="suggestion"]').suggestion(),$('[data-toggle="file-manager"]').fileManager()}),function(t){t.fn.camera=function(n){return this.each(function(){switch(n){case"play":t.fn.camera.play.apply(this);break;case"stop":t.fn.camera.stop.apply(this);break;case"snapshot":t.fn.camera.snapshot.apply(this)}})}}(jQuery),function(t){t.fn.chat=function(){return this.each(function(){var n=t(window),e=t(".app-content"),i=t(this),a=i.find(".chat-messages");n.on("resize",function(){var n=0;e.children().each(function(){t(this).is(".chat")||(n+=t(this).outerHeight(!0))}),i.height(e.height()-n),i.addClass("chat-on"),a.scrollToBottom()}),n.trigger("resize")})}}(jQuery),function(t){t.fn.fileManager=function(){return this.each(function(){var n=t(this),e=t("<input/>").attr("type","file");e.on("change",function(){var i=e.get(0).files[0];i&&(t.fn.fileManager.validate(i,n),t.fn.fileManager.read(i,function(){n.trigger("file:change",i)}))}),n.on("click",function(){e.trigger("click")})})}}(jQuery),function(t){t.fn.asInput=function(){return this.each(function(){var n=t(this),e=n.find("input"),i=function(){n.toggleClass("disabled",e.is("[disabled]")),n.toggleClass("readonly",e.is("[readonly]"))};n.on("click",function(){e.focus()}),e.on("focus",function(){n.addClass("focus")}).on("blur",function(){n.removeClass("focus")}).observe(i),i()})}}(jQuery),function(t){t.fn.suggestion=function(n){return this.each(function(){(function(){t(this).data("suggestion:initialized")||(t.fn.suggestion.select.apply(this),t.fn.suggestion.change.apply(this),t(this).is("[data-async]")?t.fn.suggestion.async.apply(this):t.fn.suggestion.static.apply(this),t(this).data("suggestion:initialized",!0))}).apply(this),"refresh"===n&&t(this).trigger("suggestion:refresh")})}}(jQuery),$.fn.onFocusOut=function(t){return this.each(function(){var n=$(document),e=$(this);function i(n){$(n.target).closest(e).length||"function"==typeof t&&t.call(this)}n.on("click",i),n.find("input").on("focus",i),n.find("select").on("focus",i),n.find("textarea").on("focus",i),n.find("button").on("focus",i),n.find("a").on("focus",i)})},function(t){t.fn.observe=function(n){var e=new MutationObserver(function(t){t.forEach(function(t){n.apply(t.target)})});return this.each(function(){var i=t(this);i.on("DOMAttrModified onpropertychange",function(){n.apply(this)}),e.observe(i.get(0),{attributes:!0})})}}(jQuery),function(t){t.fn.scrollToBottom=function(){return this.each(function(){var n=t(this),e=n.prop("scrollHeight");n.scrollTop(e)})}}(jQuery),$.fn.typing=function(){return this.each(function(){var t=$(this),n=null;t.on("input",function(){clearTimeout(n),n=setTimeout(function(){t.trigger("input:delay")},700)})})},$(function(){$('[data-toggle="sidebar"]').on("click",function(){$(".app-sidebar").addClass("sidebar-open")}),$('[data-dismiss="sidebar"]').on("click",function(){$(".app-sidebar").removeClass("sidebar-open")})}),window.keyboard=function(t){return this.isArrowDown=function(){return 40===t},this.isArrowUp=function(){return 38===t},this.isEnter=function(){return 13===t},this.isEscape=function(){return 27===t},this},String.prototype.contains=function(t){return new RegExp(t,"i").test(this)},String.prototype.replaceAll=function(t,n){return this.replace(new RegExp(t,"g"),n)},jQuery.fn.camera.toBlob=function(t){var n;n=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);for(var e=t.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(n.length),a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return new Blob([i],{type:e})},jQuery.fn.camera.link=function(t,n){if("srcObject"in t)t.srcObject=n;else if(navigator.mozGetUserMedia)t.mozSrcObject=n;else{var e=window.URL||window.webkitURL||window.mozURL||window.msURL;t.src=e.createObjectURL(n)}},jQuery.fn.camera.getUserMedia=function(t,n,e){navigator.getUserMedia?navigator.getUserMedia(t,n,e):navigator.webkitGetUserMedia?navigator.webkitGetUserMedia(t,n,e):navigator.mozGetUserMedia?navigator.mozGetUserMedia(t,n,e):navigator.msGetUserMedia&&navigator.msGetUserMedia(t,n,e)},function(t){t.fn.camera.play=function(){var n=t(this);if(!n.prop("playing")){var e=n.get(0);t.fn.camera.getUserMedia({video:!0,audio:!1},function(i){t.fn.camera.link(e,i),e.play(),n.prop("stream",i),n.prop("playing",!0),n.trigger("camera:play")},function(t){n.trigger("camera:error",{error:"No camera available."})})}}}(jQuery),function(t){var n=/^(\d+)x(\d+)$/gi;t.fn.camera.snapshot=function(){var e=t(this);if(e.prop("playing")){var i=e.get(0),a=function(t){if(!t.match(n))return{width:320,height:240};var e=n.exec(t);return{width:e[1],height:e[2]}}(e.attr("data-size")),r=document.createElement("canvas");r.width=a.width,r.height=a.height;var o=r.getContext("2d");o.translate(a.width,0),o.scale(-1,1),o.drawImage(i,0,0,a.width,a.height);var s=r.toDataURL(),c=t.fn.camera.toBlob(s);c.dataURL=s,e.trigger("camera:snapshot",c)}}}(jQuery),function(t){t.fn.camera.stop=function(){var n=t(this);if(n.prop("playing")){var e=n.prop("stream");if(e.getVideoTracks&&"function"==typeof e.getVideoTracks){var i=e.getVideoTracks();i&&i[0]&&i[0].stop&&i[0].stop()}else e.stop&&e.stop();n.prop("playing",!1),n.prop("stream",null),n.trigger("camera:stop")}}}(jQuery),jQuery.fn.fileManager.read=function(t,n){var e=new FileReader;e.readAsDataURL(t),e.onload=function(e){t.dataURL=e.target.result,n()}},function(t){t.fn.fileManager.validate=function(n,e){var i=e.attr("data-maxsize"),a=e.attr("data-type");n.errors=[],t.fn.fileManager.validate.maxsize(n,i)||n.errors.push("maxsize"),t.fn.fileManager.validate.type(n,a)||n.errors.push("type")}}(jQuery),function(t){t.fn.suggestion.async=function(){var n=t(this),e=n.closest(".input-suggestion").find(".input-suggestion-list"),i=e.find(".list-group.items").hide(),a=e.find(".list-group.empty").hide(),r=e.find(".list-group.loading").hide();n.on("input",function(){r.show(),a.hide(),i.hide()}).on("input:delay suggestion:show",function(){n.trigger("suggestion:search")}).on("suggestion:refresh",function(){t.fn.suggestion.change.apply(this),i.children().length?i.show():a.show(),r.hide()})}}(jQuery),function(t){t.fn.suggestion.change=function(){var n=t(this),e=n.closest(".input-suggestion"),i=e.find(".input-suggestion-list").find(".list-group.items").children(),a=function(e){n.val(t.fn.suggestion.textOf(e)),n.trigger("suggestion:change",e)};i.on("click",function(){e.removeClass("open"),a(this)}),n.on("keypress",function(t){var n=t.keyCode||t.which;if(keyboard(n).isEnter()){var e=i.filter(".active");e.length&&a(e.filter(".active"))}})}}(jQuery),function(t){t.fn.suggestion.select=function(){var n=t(this),e=n.closest(".input-suggestion"),i=e.find(".input-suggestion-list").find(".list-group.items"),a=function(){e.is(".open")||(i.children().removeClass("active"),e.addClass("open"),n.trigger("suggestion:show"))},r=function(){e.is(".open")&&(e.removeClass("open"),n.trigger("suggestion:hide"))};e.onFocusOut(r),n.on("input",a).on("keyup",function(t){var n=t.keyCode||t.which;keyboard(n).isEscape()&&r()}).on("keydown",function(t){var n=t.keyCode||t.which,r=keyboard(n);if(r.isArrowUp()||r.isArrowDown()){if(t.preventDefault(),!e.is(".open"))return void a();var o=i.children(".active");if(r.isArrowDown()){if(o.is(":last-child"))return;o.length?(o.removeClass("active"),o.next().addClass("active")):i.children().eq(0).addClass("active")}if(r.isArrowUp()){if(o.is(":first-child"))return;o.removeClass("active"),o.prev().addClass("active")}}}).on("suggestion:change",r)}}(jQuery),function(t){t.fn.suggestion.static=function(){var n=t(this),e=n.closest(".input-suggestion").find(".input-suggestion-list"),i=e.find(".list-group.empty").hide(),a=e.find(".list-group.items"),r=a.children(),o=[],s=function(){r.removeClass("active"),o.forEach(function(t){var n=t.data("prev");n.length?t.insertAfter(n):a.prepend(t)}),o=[],r.each(function(){var e=t(this);t.fn.suggestion.textOf(e).contains(n.val())||(o.push(e),e.data("prev",e.prev()))}),o.forEach(function(t){t.detach()}),a.children().length?(i.hide(),a.show()):(a.hide(),i.show())};n.on("input",s).on("suggestion:show",s)}}(jQuery),function(t){t.fn.suggestion.textOf=function(n){var e=t(n),i=e.closest(".input-suggestion").find("input");return i.is("[data-text]")&&(e=e.find(i.attr("data-text"))),e.text().trim()}}(jQuery),function(t){var n=/^(\d*\.?\d+)(B|KB|MB|GB)?$/gi,e={B:0,KB:1,MB:2,GB:3};jQuery.fn.fileManager.validate.maxsize=function(t,i){if(!i)return!0;if(!i.match(n))return!1;var a=n.exec(i),r=a[1],o=a[2];return t.size<=(s=r,c=o,Number(s)*Math.pow(1024,e[c]));var s,c}}(),jQuery.fn.fileManager.validate.type=function(t,n){if(!n)return!0;var e="^"+n.replaceAll(",","|")+"$";return new RegExp(e).test(t.type)};